<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:tx="http://www.springframework.org/schema/tx"
		
	xsi:schemaLocation="http://www.springframework.org/schema/beans	http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
	    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">

<!-- For Annotation based tx START -->
 <tx:annotation-driven/>
 <!-- For Annotation based tx END -->
<tx:advice id="txAdvice" transaction-manager="transactionManager">
	    <tx:attributes>
	      <!-- <tx:method name="get*" read-only="true"/>   -->
          <tx:method name="saveStockRequisition*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/> 
	      <tx:method name="generateAutoRequisitionByOffice*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/>
	      <tx:method name="saveOrUpdateBill*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/> 
	      <tx:method name="consolidateAutoRequisitionByRHO*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/> 
	      <tx:method name="isValidSeriesForReceipt*" read-only="true"/>  
	      <tx:method name="isSeriesValid*" read-only="true"/>  
	      <tx:method name="createExpenseFromStockPayment*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/> 
	      <tx:method name="saveOrUpdateHeldUp*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/>
	      <tx:method name="saveLead*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/> 
  		  <tx:method name="savePlan*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/> 
		 <tx:method name="saveUserForCust*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/>
		 <tx:method name="validateCollection*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/>
		 <tx:method name="saveOrUpdateCN*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/>
		 <tx:method name="saveSelectedUsers" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/>
		 <tx:method name="processDeliveryDetailsForCollection*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/> 
		 <tx:method name="saveColoading*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/>
		 <tx:method name="calculateAndSaveRate*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/>
	     <tx:method name="updateCdAwbDetails*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/>
	      <tx:method name="saveStockReceiptList*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/>
	       <tx:method name="saveOrUpdateStockConsumptionLevel*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/>
	       <tx:method name="saveStockConsumptionLevel*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/>
	        <tx:method name="consolidateStockConsumptionDtls*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/>	        
	        <tx:method name="saveLiability*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/>
	        <!-- <tx:method name="saveOrUpdateCustModification*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/>
	        <tx:method name="saveOrUpdateBulkCustModification*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/> -->
	        <tx:method name="saveOrUpdateConsignmentModification*" propagation="REQUIRES_NEW" isolation="READ_COMMITTED" rollback-for="java.lang.Exception"/>
		</tx:attributes>
   </tx:advice>
<aop:config>
	<!-- TODO 
		if everyone followed same roll back exception and 
		same point cut then the following commented one line tx advice is enough to configure every service layer.  
		
		otherwise separate service layer configuration is required. 
		-->
<!-- AOP point cuts and advisors for Config ADMIN ======START -->

			<aop:pointcut id="requisition" expression="execution(* com.ff.admin.stockmanagement.stockrequisition.service.*.*(..))" />
			<aop:pointcut id="autoRequisition" expression="execution(* com.ff.admin.stockmanagement.autorequisition.service.*.*(..))" />
			<aop:pointcut id="mecCollection" expression="execution(* com.ff.admin.mec.collection.service.*.*(..))" />
			<aop:pointcut id="validateSeriesForReceipt" expression="execution(* com.ff.admin.stockmanagement.stockreceipt.service.StockReceiptServiceImpl.*(..))" />
			<aop:pointcut id="validateSeries" expression="execution(* com.ff.admin.stockmanagement.common.service.StockCommonServiceImpl.*(..))" />
			<aop:pointcut id="stockIntegrator" expression="execution(* com.ff.admin.stockmanagement.common.service.StockScheduledServiceImpl.*(..))" />
			<aop:pointcut id="saveHeldUp" expression="execution(* com.ff.admin.heldup.service.*.*(..))" />
			<aop:pointcut id="saveLeads" expression="execution(* com.ff.admin.leads.service.*.*(..))" />
			<aop:pointcut id="saveRateConfig" expression="execution(* com.ff.rate.configuration.rateConfiguration.service.*.*(..))" />
			<aop:pointcut id="saveUserForCust" expression="execution(* com.ff.umc.service.*.*(..))" />
			<aop:pointcut id="saveMec" expression="execution(* com.ff.admin.mec.expense.service.*.*(..))" />
			<aop:pointcut id="saveOrUpdateLiability" expression="execution(* com.ff.admin.mec.liability.service.*.*(..))" />
			<aop:pointcut id="validate" expression="execution(* com.ff.admin.mec.collection.service.*.*(..))" />
			<aop:pointcut id="saveOrUpdate" expression="execution(* com.ff.admin.mec.collection.service.*.*(..))" />
			<aop:pointcut id="saveSelectedUsers" expression="execution(* com.ff.umc.service.*.*(..))" />
			<aop:pointcut id="drsCollectionIntegrator" expression="execution(* com.ff.universe.drs.service.DeliveryUniversalServiceImpl.*(..))" />
			<aop:pointcut id="saveColoading" expression="execution(* com.ff.admin.coloading.service.*.*(..))" />
			<aop:pointcut id="calculateAndSaveRate" expression="execution(* com.ff.admin.coloading.service.*.*(..))" />
			<aop:pointcut id="stockExcelUpload" expression="execution(* com.ff.admin.stockmanagement.excelupload.dao.StockExcelUploadDAOImpl.*(..))" />
			<aop:pointcut id="stockReductionDao" expression="execution(* com.ff.admin.stockmanagement.stockreduction.dao.StockReductionDAOImpl.*(..))" />
			<aop:pointcut id="stockConsumptionService" expression="execution(* com.ff.admin.stockmanagement.stockreduction.service.StockReductionServiceImpl.*(..))" />
			<!-- <aop:pointcut id="saveOrUpdateCustModification" expression="execution(* com.ff.admin.billing.service.CustModificationServiceImpl.*(..))" />
			<aop:pointcut id="saveOrUpdateBulkCustModification" expression="execution(* com.ff.admin.billing.service.BulkCustModificationServiceImpl.*(..))" /> -->
			<aop:pointcut id="saveOrUpdateConsignmentModification" expression="execution(* com.ff.admin.billing.service.CnModificationCommonServiceImpl.*(..))" />
<!-- AOP point cuts and advisors for central server ======END -->
		 
<!-- ================================AOP Advisors STARTS==================================================================-->
				<aop:advisor advice-ref="txAdvice" pointcut-ref="requisition" />
				<aop:advisor advice-ref="txAdvice" pointcut-ref="validateSeriesForReceipt" />
				<aop:advisor advice-ref="txAdvice" pointcut-ref="validateSeries" />
				<aop:advisor advice-ref="txAdvice" pointcut-ref="autoRequisition" />
				<aop:advisor advice-ref="txAdvice" pointcut-ref="mecCollection" />
				<aop:advisor advice-ref="txAdvice" pointcut-ref="stockIntegrator" />
		        <aop:advisor advice-ref="txAdvice" pointcut-ref="saveHeldUp" />
		        <aop:advisor advice-ref="txAdvice" pointcut-ref="saveLeads" />
		        <aop:advisor advice-ref="txAdvice" pointcut-ref="saveRateConfig" />
		      	<aop:advisor advice-ref="txAdvice" pointcut-ref="saveUserForCust"/>
		      	<aop:advisor advice-ref="txAdvice" pointcut-ref="saveMec"/>
		      	<aop:advisor advice-ref="txAdvice" pointcut-ref="saveOrUpdateLiability"/>
		      	<aop:advisor advice-ref="txAdvice" pointcut-ref="validate"/>
		      	<aop:advisor advice-ref="txAdvice" pointcut-ref="saveOrUpdate"/>
		      	<aop:advisor advice-ref="txAdvice" pointcut-ref="drsCollectionIntegrator"/>
		        <aop:advisor advice-ref="txAdvice" pointcut-ref="saveColoading"/>
		        <aop:advisor advice-ref="txAdvice" pointcut-ref="calculateAndSaveRate"/>
		      	<aop:advisor advice-ref="txAdvice" pointcut-ref="stockExcelUpload" />
		      	<aop:advisor advice-ref="txAdvice" pointcut-ref="stockReductionDao" />
		      	<aop:advisor advice-ref="txAdvice" pointcut-ref="stockConsumptionService" />
		      	<!-- <aop:advisor advice-ref="txAdvice" pointcut-ref="saveOrUpdateCustModification" />
		      	<aop:advisor advice-ref="txAdvice" pointcut-ref="saveOrUpdateBulkCustModification" /> -->
		      	<aop:advisor advice-ref="txAdvice" pointcut-ref="saveOrUpdateConsignmentModification" />
<!-- ================================AOP Advisors ENDS==================================================================-->	
  
   </aop:config>


</beans>