<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
	<class name="com.ff.domain.pickup.PickupRunsheetDetailDO" table="ff_f_pickup_runsheet_detail">
		<id name="runsheetDetailId" type="java.lang.Integer">
			<column name="RUNSHEET_DETAIL_ID" />
			<generator class="native" />
		</id>
		<property name="pickupTime" column="PICKUP_TIME"/>			
		<property name="startCnNo" column ="START_CN_NO" type="java.lang.String"/>
		<property name="endCnNo" column ="END_CN_NO" type="java.lang.String"/>
		<property name="cnCount" column ="CN_COUNT" type="java.lang.Integer"/>
		<property name="duplicateCustRow" column ="DUPLICATE_CUST_ROW" type="java.lang.String"/>
		<property name="createdBy" column ="CREATED_BY" type="java.lang.Integer"/>
        <property name="updatedBy" column ="UPDATE_BY" type="java.lang.Integer"/>         
        <property name="transactionCreateDate" column ="CREATION_DATE" type="java.util.Date" update="false"/>
        <property name="transactionModifiedDate" column ="UPDATE_DATE" type="java.util.Date"/>
        <property name="dtToCentral" column ="DT_TO_CENTRAL"/>
		<property name="dtUpdateToCentral" column ="DT_UPDATE_TO_CENTRAL"/>
		
        <many-to-one name="runsheetHeaderDtls" class="com.ff.domain.pickup.PickupRunsheetHeaderDO" lazy="false" fetch="join">
        	<column name="RUNSHEET_HEADER_ID" />
        </many-to-one>
		<many-to-one name="pickupAssignmentDtls" class="com.ff.domain.pickup.RunsheetAssignmentDetailDO" lazy="false" fetch="join">
        	<column name="PICKUP_ASSIGNMENT_DETAIL_ID" />
        </many-to-one>
	</class>
	
	<sql-query name="generatePickUpCommissionCount" callable="true">
	    <![CDATA[CALL sp_gen_input_for_commission_calculation(:lastMonthDate)]]>
	</sql-query>
	
	<!--Start.....................Update Pickup runsheet status when consignment booked From Manifest .....................-->
	<query name="getPickupRunsheetHeaderByConsignmentNo">
		<![CDATA[
				SELECT	pkupRunsheetHeader 
				FROM 	com.ff.domain.pickup.PickupRunsheetDetailDO  pickupRunsheetDetails
				INNER JOIN pickupRunsheetDetails.runsheetHeaderDtls pkupRunsheetHeader
				WHERE 	(:consgNo BETWEEN pickupRunsheetDetails.startCnNo AND pickupRunsheetDetails.endCnNo)
		]]>
	</query>
	<!--End.....................Update Pickup runsheet status when consignment booked From Manifest .....................-->
</hibernate-mapping>	