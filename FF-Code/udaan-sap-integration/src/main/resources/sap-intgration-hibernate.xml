<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:tx="http://www.springframework.org/schema/tx"
		
	xsi:schemaLocation="http://www.springframework.org/schema/beans	http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
	    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">
	

	<!-- <bean id="jdbc" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
		<property name="location" value="WEB-INF/jdbc.properties" />
	</bean> -->

	<bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    	<property name="locations" >
            <list>
                 <value>WEB-INF/jdbc.properties</value>
                 <value>classpath:email.properties</value>
                 <value>classpath:csd-sap-config.properties</value>
            </list>
        </property>
	</bean>

	<bean id="DTDCDataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource" destroy-method="close">  
	    <!-- Connection properties -->
		<property name="driverClass" value="${jdbc.mysql.driverClassName}" />
		<property name="jdbcUrl" value="${udaan.jdbc.url}" />
		<property name="user" value="${jdbc.retail.user}" />
		<property name="password" value="${jdbc.retail.password}" />
		
		<!-- Basic Pool Configuration -->
		<property name="initialPoolSize" value="${initialPoolSize}" />
		<property name="minPoolSize" value="${minPoolSize}" />
		<property name="maxPoolSize" value="${maxPoolSize}" /><!-- No of connecton -->
		<property name="maxIdleTime" value="${maxIdleTime}" />
		<property name="acquireIncrement" value="${acquireIncrement}" />
		
		<!-- Configuring Connection Testing -->		
		<property name="idleConnectionTestPeriod" value="${idleConnectionTestPeriod}" />
		<property name="preferredTestQuery" value="${preferredTestQuery}" />
		
		
		<!-- Configuring Statement Pooling -->
		<property name="maxStatements" value="${maxStatements}" /> <!-- 0 means: statement caching is turned off.  -->
		<property name="numHelperThreads" value="${numHelperThreads}" />
		
		<!-- Configuring Recovery From Database Outages -->
		<property name="acquireRetryAttempts" value="${acquireRetryAttempts}" />
		<property name="AcquireRetryDelay" value="${AcquireRetryDelay}" />
		<property name="BreakAfterAcquireFailure" value="${BreakAfterAcquireFailure}" />
		
		<!--Other DataSource Configuration-->
		<property name="checkoutTimeout" value="${checkoutTimeout}" />
		
		<!--Configuring to Debug and Workaround Broken Client Applications, Don't use these in production'-->		
		<property name="unreturnedConnectionTimeout" value="${unreturnedConnectionTimeout}" />
		<property name="debugUnreturnedConnectionStackTraces" value="${debugUnreturnedConnectionStackTraces}"/>

		
	</bean>
	<bean id="hibernateSessionFactory"
		class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
		<property name="dataSource" ref="DTDCDataSource" />
		
		<!-- For TESTing & production Environment START -->
  			 <property name="mappingJarLocations" value="WEB-INF/lib/udaan-domain*.jar"/> 

		<!-- For TESTing & production Environment END -->

		<!-- For Development START -->
   			<!-- <property name="mappingLocations">
                  <list>
            		<value> classpath*:/**/*.hbm.xml</value>  
           		  </list>
            </property>  -->
		<!-- For Development END -->

		<property name="hibernateProperties">
			<props>
				<prop key="hibernate.dialect">${hibernate.mysql.dialect}</prop>
				<prop key="hibernate.show_sql">${hibernate.show_sql}</prop>
				<prop key="hibernate.format_sql">${hibernate.format_sql}</prop>
				<prop key="hibernate.connection.autocommit">${hibernate.connection.autocommit}</prop>
				<prop key="hibernate.connection.release_mode">${hibernate.connection.release_mode}</prop>
				<!-- <prop key="hibernate.current_session_context_class">${hibernate.current_session_context_class}</prop>
				<prop key="hibernate.transaction.factory_class">${hibernate.transaction.factory_class}</prop> -->
			<!--  <prop key="hibernate.current_session_context_class">${hibernate.current_session_context_class}</prop> 
				<prop key="hibernate.transaction.factory_class">${hibernate.transaction.factory_class}</prop> -->
				
				<!-- enable second level cache and query cache -->
				<prop key="hibernate.cache.use_second_level_cache">true</prop>
				<prop key="net.sf.ehcache.configurationResourceName">udaan-hibernate-ehcache.xml</prop>
				<!-- <prop key="hibernate.cache.provider_configuration_file_resource_path">myehcache.xml</prop> -->
				<prop key="hibernate.cache.region.factory_class">net.sf.ehcache.hibernate.EhCacheRegionFactory</prop>
				
				<!-- to enable Query statistics <prop key="hibernate.generate_statistics">true</prop> -->
				<!-- It specifies whether entries will be written in a readable format 
					or not in the L2 cache. You probably should turn it on if you plan to browse 
					through the cache. <prop key="hibernate.cache.use_structured_entries">true</prop> -->
			</props>
		</property>
	</bean>
	<bean id="transactionManager" class="org.springframework.orm.hibernate3.HibernateTransactionManager">
		<property name="sessionFactory" ref="hibernateSessionFactory"/>
	</bean>
</beans>